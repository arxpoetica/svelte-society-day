{#if loaded}
	<div
		class="sprite"
		on:click={toggle_awake}
		style="
			width:{width}rem;
			height:{height}rem;
			transform:translateX({threshold * 1100}rem);
		"
	>
		<!-- <div style="color:white;">{Math.round(threshold * 250) % 8}</div> -->
		<Sprite img={img_run} {current} {width} {height}/>
	</div>
{/if}

<script>
	export let threshold

	import { onMount } from 'svelte'
	import Sprite from './Sprite.svelte'

	let loaded = false

	let img_run
	let width = 203
	let height = 300
	$: current = Math.round(threshold * 100) % 8

	// let img_idle
	// let width = 185
	// let height = 309

	onMount(() => {
		img_run = new Image()
		img_run.onload = () => loaded = true
		img_run.src = '/img/sprites/man/run.png';

		// img_idle = new Image()
		// img_idle.onload = () => loaded = true
		// img_idle.src = '/img/sprites/man/idle.png';
	})



	// let now = Date.now()
	// var fps = 12
	// let fps_interval = 1000 / fps
	// let then = Date.now()
	// let elapsed
	// let current = 0

	// let req
	// function animate() {
	// 	req = requestAnimationFrame(animate)
	// 	now = Date.now()
	// 	elapsed = now - then
	// 	if (elapsed > fps_interval) {
	// 		then = now - (elapsed % fps_interval)
	// 		current = current < 11 ? current + 1 : 0
	// 	}
	// }
	function toggle_awake() {
		// if (req) {
		// 	cancelAnimationFrame(req)
		// 	req = undefined
		// } else {
		// 	req = requestAnimationFrame(animate)
		// }
	}
</script>

<style type="text/scss">
	.sprite {
		position: absolute;
		bottom: 0;
		cursor: pointer;
	}
</style>
