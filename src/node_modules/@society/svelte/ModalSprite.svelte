<IntersectionObserver bind:elem bind:intersecting bind:threshold/>
<div bind:this={elem} class="modal modal-sprite">
	<div class="content">
		<div class="bg sky" style="transform:translateY(-{threshold * 150}rem);"></div>
		<div class="bg mountains-far" style="transform:translateX(-{threshold * 400}rem);"></div>
		<div class="bg mountains-near" style="transform:translateX(-{(threshold * 600) + 300}rem);"></div>
		<div class="bg trees-far" style="transform:translateX(-{threshold * 900}rem);"></div>
		<div class="bg trees-near" style="transform:translateX(-{threshold * 1200}rem);"></div>
		<Man {threshold}/>
		<!-- <AudioClip {intersecting} {threshold} src="/audio/game-music.mp3" volume={0.25}/> -->
		<AudioClip {intersecting} src="/audio/game-music.mp3" volume={0.25}/>
	</div>
	<!-- <InfoBlock {elem} {intersecting} {threshold}/> -->
</div>

<script>
	import { story_scroll, view_height } from '../js/stores.js'
	import IntersectionObserver from './IntersectionObserver.svelte'
	let elem, intersecting, threshold

	import Man from './sprites/Man.svelte'
	import AudioClip from './media/AudioClip.svelte'
	// import InfoBlock from '@society/svelte/InfoBlock.svelte'
</script>

<style type="text/scss">
	.modal-sprite {
		overflow: visible;
		// height: calc(100vh - 100rem);
		height: 600vh;
		// background-color: deepskyblue;
		background-image: linear-gradient(to bottom, #001122, lightblue);
	}
	.content {
		overflow: hidden;
		position: sticky;
		top: -1rem;
		height: calc(100vh - 99rem);
		width: 100%;
	}
	.bg {
		position: absolute;
		bottom: 0;
		left: 0;
		height: 100vh;
		width: 300%;
		background: none repeat-x center bottom transparent;
		background-size: contain;
	}
	.sky {
		width: 100%;
		height: 100vh;
		background: url('/img/sprites/bg/blue-sky.png') no-repeat center top transparent;
		background-size: cover;
	}
	.mountains-far {
		width: 130%;
		height: 70vh;
		background-image: url('/img/sprites/bg/blue-montains-far.png');
	}
	.mountains-near {
		height: 30vh;
		background-image: url('/img/sprites/bg/blue-montains-near.png');
	}
	.trees-far {
		height: 50vh;
		background-image: url('/img/sprites/bg/blue-trees-far.png');
	}
	.trees-near {
		height: 50vh;
		background-image: url('/img/sprites/bg/blue-trees-near.png');
	}
</style>
