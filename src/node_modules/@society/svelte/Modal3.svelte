<IntersectionObserver bind:elem bind:intersecting>
	{#if elem}
		<div class="modal modal-3" {style}>
		</div>
	{/if}
</IntersectionObserver>

<script>
	import { story_scroll, view_height } from '@society/js/stores.js'
	import IntersectionObserver from '@society/svelte/IntersectionObserver.svelte'

	let elem
	let intersecting

	function animate(scroll) {
		const { top, height } = elem.getBoundingClientRect()
		const threshold = 1 - Math.min(Math.max((top + height) / ($view_height + height), 0), 1)
		return `transform:scale(${1 + (threshold * 0.25)});`
	}
	$: style = intersecting ? animate($story_scroll) : undefined
</script>

<style type="text/scss">
	.modal-3 {
		background-image: url('https://pi.tedcdn.com/r/talkstar-assets.s3.amazonaws.com/production/playlists/playlist_492/rocket_science_1200x627.jpg?quality=89&w=800');
	}
</style>
